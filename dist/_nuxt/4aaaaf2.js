(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{357:function(e,t,r){var map={"./af":222,"./af.js":222,"./ar":223,"./ar-dz":224,"./ar-dz.js":224,"./ar-kw":225,"./ar-kw.js":225,"./ar-ly":226,"./ar-ly.js":226,"./ar-ma":227,"./ar-ma.js":227,"./ar-sa":228,"./ar-sa.js":228,"./ar-tn":229,"./ar-tn.js":229,"./ar.js":223,"./az":230,"./az.js":230,"./be":231,"./be.js":231,"./bg":232,"./bg.js":232,"./bm":233,"./bm.js":233,"./bn":234,"./bn-bd":235,"./bn-bd.js":235,"./bn.js":234,"./bo":236,"./bo.js":236,"./br":237,"./br.js":237,"./bs":238,"./bs.js":238,"./ca":239,"./ca.js":239,"./cs":240,"./cs.js":240,"./cv":241,"./cv.js":241,"./cy":242,"./cy.js":242,"./da":243,"./da.js":243,"./de":244,"./de-at":245,"./de-at.js":245,"./de-ch":246,"./de-ch.js":246,"./de.js":244,"./dv":247,"./dv.js":247,"./el":248,"./el.js":248,"./en-au":249,"./en-au.js":249,"./en-ca":250,"./en-ca.js":250,"./en-gb":251,"./en-gb.js":251,"./en-ie":252,"./en-ie.js":252,"./en-il":253,"./en-il.js":253,"./en-in":254,"./en-in.js":254,"./en-nz":255,"./en-nz.js":255,"./en-sg":256,"./en-sg.js":256,"./eo":257,"./eo.js":257,"./es":258,"./es-do":259,"./es-do.js":259,"./es-mx":260,"./es-mx.js":260,"./es-us":261,"./es-us.js":261,"./es.js":258,"./et":262,"./et.js":262,"./eu":263,"./eu.js":263,"./fa":264,"./fa.js":264,"./fi":265,"./fi.js":265,"./fil":266,"./fil.js":266,"./fo":267,"./fo.js":267,"./fr":268,"./fr-ca":269,"./fr-ca.js":269,"./fr-ch":270,"./fr-ch.js":270,"./fr.js":268,"./fy":271,"./fy.js":271,"./ga":272,"./ga.js":272,"./gd":273,"./gd.js":273,"./gl":274,"./gl.js":274,"./gom-deva":275,"./gom-deva.js":275,"./gom-latn":276,"./gom-latn.js":276,"./gu":277,"./gu.js":277,"./he":278,"./he.js":278,"./hi":279,"./hi.js":279,"./hr":280,"./hr.js":280,"./hu":281,"./hu.js":281,"./hy-am":282,"./hy-am.js":282,"./id":283,"./id.js":283,"./is":284,"./is.js":284,"./it":285,"./it-ch":286,"./it-ch.js":286,"./it.js":285,"./ja":287,"./ja.js":287,"./jv":288,"./jv.js":288,"./ka":289,"./ka.js":289,"./kk":290,"./kk.js":290,"./km":291,"./km.js":291,"./kn":292,"./kn.js":292,"./ko":293,"./ko.js":293,"./ku":294,"./ku.js":294,"./ky":295,"./ky.js":295,"./lb":296,"./lb.js":296,"./lo":297,"./lo.js":297,"./lt":298,"./lt.js":298,"./lv":299,"./lv.js":299,"./me":300,"./me.js":300,"./mi":301,"./mi.js":301,"./mk":302,"./mk.js":302,"./ml":303,"./ml.js":303,"./mn":304,"./mn.js":304,"./mr":305,"./mr.js":305,"./ms":306,"./ms-my":307,"./ms-my.js":307,"./ms.js":306,"./mt":308,"./mt.js":308,"./my":309,"./my.js":309,"./nb":310,"./nb.js":310,"./ne":311,"./ne.js":311,"./nl":312,"./nl-be":313,"./nl-be.js":313,"./nl.js":312,"./nn":314,"./nn.js":314,"./oc-lnc":315,"./oc-lnc.js":315,"./pa-in":316,"./pa-in.js":316,"./pl":317,"./pl.js":317,"./pt":318,"./pt-br":319,"./pt-br.js":319,"./pt.js":318,"./ro":320,"./ro.js":320,"./ru":321,"./ru.js":321,"./sd":322,"./sd.js":322,"./se":323,"./se.js":323,"./si":324,"./si.js":324,"./sk":325,"./sk.js":325,"./sl":326,"./sl.js":326,"./sq":327,"./sq.js":327,"./sr":328,"./sr-cyrl":329,"./sr-cyrl.js":329,"./sr.js":328,"./ss":330,"./ss.js":330,"./sv":331,"./sv.js":331,"./sw":332,"./sw.js":332,"./ta":333,"./ta.js":333,"./te":334,"./te.js":334,"./tet":335,"./tet.js":335,"./tg":336,"./tg.js":336,"./th":337,"./th.js":337,"./tk":338,"./tk.js":338,"./tl-ph":339,"./tl-ph.js":339,"./tlh":340,"./tlh.js":340,"./tr":341,"./tr.js":341,"./tzl":342,"./tzl.js":342,"./tzm":343,"./tzm-latn":344,"./tzm-latn.js":344,"./tzm.js":343,"./ug-cn":345,"./ug-cn.js":345,"./uk":346,"./uk.js":346,"./ur":347,"./ur.js":347,"./uz":348,"./uz-latn":349,"./uz-latn.js":349,"./uz.js":348,"./vi":350,"./vi.js":350,"./x-pseudo":351,"./x-pseudo.js":351,"./yo":352,"./yo.js":352,"./zh-cn":353,"./zh-cn.js":353,"./zh-hk":354,"./zh-hk.js":354,"./zh-mo":355,"./zh-mo.js":355,"./zh-tw":356,"./zh-tw.js":356};function n(e){var t=o(e);return r(t)}function o(e){if(!r.o(map,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return map[e]}n.keys=function(){return Object.keys(map)},n.resolve=o,e.exports=n,n.id=357},365:function(e,t,r){var content=r(386);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(47).default)("a68f70e6",content,!0,{sourceMap:!1})},366:function(e,t,r){var content=r(388);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(47).default)("387ed1e9",content,!0,{sourceMap:!1})},385:function(e,t,r){"use strict";r(365)},386:function(e,t,r){var n=r(46)(!1);n.push([e.i,".row-wrapper[data-v-62c10504]{display:flex;flex-direction:row}.row-wrapper>*[data-v-62c10504]{flex:1}.row-wrapper[data-v-62c10504]>:not(:first-child){padding-left:20px}",""]),e.exports=n},387:function(e,t,r){"use strict";r(366)},388:function(e,t,r){var n=r(46)(!1);n.push([e.i,".username-message[data-v-5f21a86f]{font-size:.75rem}.entire-field[data-v-5f21a86f]{display:flex;flex-direction:column}.label-and-input[data-v-5f21a86f]{display:flex;flex-direction:row;align-items:center}.custom-b-input[data-v-5f21a86f]{margin-left:10px}.custom-label[data-v-5f21a86f]{margin-bottom:0!important}.custom-label[data-v-5f21a86f],.wrap-warning[data-v-5f21a86f]{display:flex;flex-direction:column}.wrap-warning[data-v-5f21a86f]{color:red}.form-construct-cards-wrapper[data-v-5f21a86f]{display:flex;flex-direction:column;flex-wrap:wrap;justify-content:space-between}.form-construct-cards-wrapper>div[data-v-5f21a86f]{margin-bottom:20px}.row-wrapper[data-v-5f21a86f]{display:flex;flex-direction:row}.row-wrapper>*[data-v-5f21a86f]{flex:1}",""]),e.exports=n},395:function(e,t,r){"use strict";r.r(t);var n=r(96);var o=r(128),c=r(76);function l(e){return function(e){if(Array.isArray(e))return Object(n.a)(e)}(e)||Object(o.a)(e)||Object(c.a)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}r(19),r(39),r(24),r(150),r(17),r(63),r(62),r(9),r(64),r(65);var d=r(221),m=r.n(d),f={name:"FormConstructCard",props:["removeConstruct","theIndex","card","mustDisableDelete","isConstructNameUnavailable","vectorSelections","tdnaSelections","agroStrains"]},v=(r(385),r(29)),j={middleware:"auth",components:{FormConstructCard:Object(v.a)(f,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"card"},[r("header",{staticClass:"card-header"},[r("p",{staticClass:"card-header-title"},[e._v("Construct #"+e._s(e.theIndex+1))]),e._v(" "),e._m(0)]),e._v(" "),r("div",{staticClass:"card-content"},[r("div",{staticClass:"row-wrapper"},[r("b-field",{attrs:{label:"Construct Name",type:e.isConstructNameUnavailable?"is-danger":null,message:e.isConstructNameUnavailable?"Name duplicated in database or on form":null}},[r("b-input",{attrs:{placeholder:"Required",required:"",maxlength:"30",value:e.card.constructName},model:{value:e.card.constructName,callback:function(t){e.$set(e.card,"constructName",t)},expression:"card.constructName"}})],1),e._v(" "),r("b-field",{attrs:{label:"Binary Vector Backbone"}},[r("b-input",{attrs:{placeholder:"Required",required:"",value:e.card.binaryVectorBackbone},model:{value:e.card.binaryVectorBackbone,callback:function(t){e.$set(e.card,"binaryVectorBackbone",t)},expression:"card.binaryVectorBackbone"}})],1)],1),e._v(" "),r("div",{staticClass:"row-wrapper"},[r("b-field",{attrs:{grouped:""}},[r("div",{staticClass:"entire-field"},[r("div",{staticClass:"label-and-input"},[r("label",{staticClass:"label"},[e._v("Vector Selection")]),e._v(" "),r("b-select",{staticClass:"custom-b-input",attrs:{placeholder:"Required",required:""},model:{value:e.card.vectorSelection,callback:function(t){e.$set(e.card,"vectorSelection",t)},expression:"card.vectorSelection"}},e._l(e.vectorSelections,(function(option){return r("option",{key:option,domProps:{value:option}},[e._v("\n                "+e._s(option)+"\n              ")])})),0)],1)])]),e._v(" "),r("b-field",{attrs:{grouped:""}},[r("div",{staticClass:"entire-field"},[r("div",{staticClass:"label-and-input"},[r("label",{staticClass:"label"},[e._v("T-DNA Selection")]),e._v(" "),r("b-select",{staticClass:"custom-b-input",attrs:{placeholder:"Required",required:""},model:{value:e.card.tdnaSelection,callback:function(t){e.$set(e.card,"tdnaSelection",t)},expression:"card.tdnaSelection"}},e._l(e.tdnaSelections,(function(option){return r("option",{key:option,domProps:{value:option}},[e._v("\n                "+e._s(option)+"\n              ")])})),0)],1)])]),e._v(" "),r("b-field",{attrs:{grouped:""}},[r("div",{staticClass:"entire-field"},[r("div",{staticClass:"label-and-input"},[r("label",{staticClass:"label"},[e._v("AgroStrains")]),e._v(" "),r("b-select",{staticClass:"custom-b-input",attrs:{placeholder:"Required",required:""},model:{value:e.card.agroStrain,callback:function(t){e.$set(e.card,"agroStrain",t)},expression:"card.agroStrain"}},e._l(e.agroStrains,(function(option){return r("option",{key:option,domProps:{value:option}},[e._v("\n                "+e._s(option)+"\n              ")])})),0)],1)])])],1)]),e._v(" "),r("footer",{staticClass:"card-footer",on:{click:function(t){return e.removeConstruct(e.theIndex)}}},[e.mustDisableDelete?e._e():r("a",{staticClass:"card-footer-item",attrs:{href:"#"}},[e._v("\n      Delete\n    ")])])])}),[function(){var e=this.$createElement,t=this._self._c||e;return t("button",{staticClass:"card-header-icon",attrs:{"aria-label":"more options"}},[t("span",{staticClass:"icon"},[t("i",{staticClass:"fas fa-angle-down",attrs:{"aria-hidden":"true"}})])])}],!1,null,"62c10504",null).exports},mounted:function(){var e=this.$auth.$state.user,t=e.username,r=e.isAdmin,n=e.signatories,o=e.isGroupLeaderForObj;this.username=t,this.isAdmin=r,this.signatories=n,this.selectedSignatory=1===n.length?n[0].name:null,this.isGroupLeaderForObj=o},asyncData:function(e){return e.$axios.get("/api/form/new").then((function(e){var t=m()().format("DD-MM-YYYY"),r=function(e){return e&&e.length?e.filter((function(e){return!e.archived})).map((function(e){return e.name})):[]},n=r(e.data.species),o=r(e.data.genotypes),c=r(e.data.vectorSelections),l=r(e.data.tdnaSelections),d=r(e.data.agroStrains);return{date:t,fetchingError:"",username:"",isAdmin:!1,signatories:[],isGroupLeaderForObj:null,selectedSignatory:null,species:n,selectedSpecies:null,autocompleteGenotypes:o,typedGenotype:"",previousConstructNames:e.data.previousConstructNames.map((function(e){return e.trim()})),constructs:[{constructName:"",binaryVectorBackbone:"",vectorSelection:null,tdnaSelection:null,agroStrain:null}],vectorSelections:c,tdnaSelections:l,agroStrains:d,notes:""}})).catch((function(e){return console.error(e),{fetchingError:"Error fetching data. Please try again later or contact system admin."}}))},methods:{submitForm:function(){var e=this,t=this.signatories.find((function(t){return t.username===e.selectedSignatory})),r=!!this.isGroupLeaderForObj,n={date:this.date,username:this.username.trim().toLowerCase(),creatorIsAdmin:this.isAdmin,creatorIsGroupLeader:r,signatoryObj:t,species:this.selectedSpecies.trim(),genotype:this.typedGenotype.trim(),constructs:this.constructs.map((function(e){return{constructName:e.constructName.trim(),binaryVectorBackbone:e.binaryVectorBackbone.trim(),vectorSelection:e.vectorSelection.trim(),tdnaSelection:e.tdnaSelection.trim(),agroStrain:e.agroStrain.trim()}})),notes:this.notes.trim()};return this.$axios.post("/api/form/new",n).then((function(t){200===t.status?(console.log("created form, trfId:",t.data.trfId,t.trfId),t.data.error?(e.$buefy.toast.open({message:"Form added to database but another error occurred: "+t.data.error,type:"is-danger"}),e.$router.push("/new")):(e.$buefy.toast.open({message:"Added to database!",type:"is-success"}),t.data.trfId?e.$router.push("/form?id=".concat(t.data.trfId)):e.$router.push("/new"))):(500===t.status&&t.data.error,e.$buefy.toast.open({message:"Unexpected error. Please contact system admin.",type:"is-danger"}),e.$router.push("/new"))})).catch((function(t){console.error(t),e.$buefy.toast.open({message:t.message||"Unexpected error. Please contact system admin.",type:"is-danger"})}))},addConstruct:function(){var e=[].concat(l(this.constructs),[{constructName:"",binaryVectorBackbone:"",vectorSelection:null,tdnaSelection:null,agroStrain:null}]);this.constructs=e},removeConstruct:function(e){var t=this.constructs.slice();t.splice(e,1),this.constructs=t},isConstructNameUnavailable:function(e){if(""===this.constructs[e].constructName)return!1;var t=this.getUnavailableConstructNames(e);if(!t||!t.length)return!1;var r=this.constructs[e].constructName.trim();return t.includes(r)},getUnavailableConstructNames:function(e){var t=this.constructs.slice();t.splice(e,1);var r=t.map((function(e){return e.constructName}));return this.previousConstructNames.concat(r)}},computed:{canSubmitForm:function(){if(!(this.date&&this.username&&this.selectedSignatory&&this.selectedSpecies&&this.typedGenotype))return!1;var e=!0;return this.constructs.forEach((function(t){t.constructName&&t.binaryVectorBackbone&&t.vectorSelection&&t.tdnaSelection&&t.agroStrain||(e=!1)})),e},filteredDataArray:function(){var e=this;return this.autocompleteGenotypes.filter((function(option){return option.toString().toLowerCase().indexOf(e.typedGenotype.toLowerCase())>=0}))},onlyOneFormConstructCard:function(){return 1===this.constructs.length}}},h=(r(387),Object(v.a)(j,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("h1",{staticClass:"title is-2"},[e._v("New Request")]),e._v(" "),e.fetchingError?r("div",[r("div",{staticClass:"error-message"},[r("div",{staticClass:"title is-3"},[e._v("Error")]),e._v(" "),r("div",{staticClass:"message"},[e._v(e._s(e.fetchingError))])])]):r("form",[r("div",{staticClass:"row-wrapper"},[r("b-field",{staticClass:"field"},[r("label",{staticClass:"label custom-label"},[e._v("Date")]),e._v(" "),r("b-input",{staticClass:"custom-b-input",attrs:{required:"",disabled:""},model:{value:e.date,callback:function(t){e.date=t},expression:"date"}})],1),e._v(" "),e.isAdmin?r("b-field",{attrs:{grouped:""}},[r("div",{staticClass:"entire-field"},[r("div",{staticClass:"label-and-input"},[r("label",{staticClass:"label"},[e._v("Username")]),e._v(" "),r("b-input",{staticClass:"custom-b-input",attrs:{required:""},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}})],1),e._v(" "),r("p",{staticClass:"username-message"},[e._v("\n            Ensure correct username & signatory if manual entry - typos\n            unforgiven! ("),r("b",[e._v("Admin")]),e._v(" only)\n          ")])])]):r("b-field",[r("label",{staticClass:"label"},[e._v("Username")]),e._v(" "),r("b-input",{staticClass:"custom-b-input",attrs:{required:"",readonly:""},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}})],1),e._v(" "),0===e.signatories.length?r("b-field",[r("div",{staticClass:"wrap-warning"},[r("div",[e._v("Warning: no signatories found!")]),e._v(" "),r("div",[e._v("Please contact admin.")])])]):1===e.signatories.length?r("b-field",[r("label",{staticClass:"label"},[e._v("Signatory")]),e._v(" "),r("b-input",{staticClass:"custom-b-input",attrs:{readonly:"",required:""},model:{value:e.selectedSignatory,callback:function(t){e.selectedSignatory=t},expression:"selectedSignatory"}})],1):r("b-field",{attrs:{grouped:""}},[r("label",{staticClass:"label"},[e._v("Signatory")]),e._v(" "),r("b-select",{staticClass:"custom-b-input",attrs:{placeholder:"Required",required:""},model:{value:e.selectedSignatory,callback:function(t){e.selectedSignatory=t},expression:"selectedSignatory"}},e._l(e.signatories,(function(option){return r("option",{key:option.username,domProps:{value:option.username}},[e._v("\n            "+e._s(option.name)+"\n          ")])})),0)],1)],1),e._v(" "),r("hr"),e._v(" "),r("div",{staticClass:"row-wrapper"},[r("b-field",{attrs:{grouped:""}},[r("div",{staticClass:"entire-field"},[r("div",{staticClass:"label-and-input"},[r("label",{staticClass:"label"},[e._v("Species")]),e._v(" "),r("b-select",{staticClass:"custom-b-input",attrs:{placeholder:"Required",required:""},model:{value:e.selectedSpecies,callback:function(t){e.selectedSpecies=t},expression:"selectedSpecies"}},e._l(e.species,(function(option){return r("option",{key:option,domProps:{value:option}},[e._v("\n                "+e._s(option)+"\n              ")])})),0)],1),e._v(" "),r("p",{staticClass:"username-message"},[e._v("\n            Please contact us if your species is unavailable\n          ")])])]),e._v(" "),r("b-field",{attrs:{grouped:""}},[r("div",{staticClass:"entire-field"},[r("div",{staticClass:"label-and-input"},[r("label",{staticClass:"label"},[e._v("Genotype")]),e._v(" "),r("b-autocomplete",{staticClass:"custom-b-input",attrs:{rounded:"",data:e.autocompleteGenotypes,required:"",placeholder:"Type to start search...",icon:"magnify",clearable:""},on:{select:function(option){return e.selected=option}},scopedSlots:e._u([{key:"empty",fn:function(){return[e._v("No results found")]},proxy:!0}],null,!1,478364837),model:{value:e.typedGenotype,callback:function(t){e.typedGenotype=t},expression:"typedGenotype"}})],1),e._v(" "),r("p",{staticClass:"username-message"},[e._v("\n            Please find your genotype above, or type in a new entry to use\n            instead\n          ")])])])],1),e._v(" "),r("hr"),e._v(" "),r("h3",{staticClass:"title is-3"},[e._v("Constructs")]),e._v(" "),r("h3",{staticClass:"title is-6"},[e._v("Please create in priority order")]),e._v(" "),r("div",{staticClass:"form-construct-cards-wrapper"},[e._l(e.constructs,(function(t,n){return r("FormConstructCard",{key:n,attrs:{theIndex:n,card:t,mustDisableDelete:e.onlyOneFormConstructCard,vectorSelections:e.vectorSelections,tdnaSelections:e.tdnaSelections,agroStrains:e.agroStrains,removeConstruct:e.removeConstruct,isConstructNameUnavailable:e.isConstructNameUnavailable(n)}})})),e._v(" "),r("b-button",{staticClass:"add-construct-button",on:{click:e.addConstruct}},[e._v("Add Construct")])],2),e._v(" "),r("hr"),e._v(" "),r("b-field",{attrs:{label:"Notes to add"}},[r("b-input",{attrs:{placeholder:"If important construct priorities, please list here...",maxlength:"200",type:"textarea"},model:{value:e.notes,callback:function(t){e.notes=t},expression:"notes"}})],1),e._v(" "),r("hr"),e._v(" "),r("b-button",{attrs:{disabled:!e.canSubmitForm},on:{click:function(t){return t.preventDefault(),e.submitForm.apply(null,arguments)}}},[e._v("Submit")])],1)])}),[],!1,null,"5f21a86f",null));t.default=h.exports}}]);