(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{357:function(e,t,r){var map={"./af":222,"./af.js":222,"./ar":223,"./ar-dz":224,"./ar-dz.js":224,"./ar-kw":225,"./ar-kw.js":225,"./ar-ly":226,"./ar-ly.js":226,"./ar-ma":227,"./ar-ma.js":227,"./ar-sa":228,"./ar-sa.js":228,"./ar-tn":229,"./ar-tn.js":229,"./ar.js":223,"./az":230,"./az.js":230,"./be":231,"./be.js":231,"./bg":232,"./bg.js":232,"./bm":233,"./bm.js":233,"./bn":234,"./bn-bd":235,"./bn-bd.js":235,"./bn.js":234,"./bo":236,"./bo.js":236,"./br":237,"./br.js":237,"./bs":238,"./bs.js":238,"./ca":239,"./ca.js":239,"./cs":240,"./cs.js":240,"./cv":241,"./cv.js":241,"./cy":242,"./cy.js":242,"./da":243,"./da.js":243,"./de":244,"./de-at":245,"./de-at.js":245,"./de-ch":246,"./de-ch.js":246,"./de.js":244,"./dv":247,"./dv.js":247,"./el":248,"./el.js":248,"./en-au":249,"./en-au.js":249,"./en-ca":250,"./en-ca.js":250,"./en-gb":251,"./en-gb.js":251,"./en-ie":252,"./en-ie.js":252,"./en-il":253,"./en-il.js":253,"./en-in":254,"./en-in.js":254,"./en-nz":255,"./en-nz.js":255,"./en-sg":256,"./en-sg.js":256,"./eo":257,"./eo.js":257,"./es":258,"./es-do":259,"./es-do.js":259,"./es-mx":260,"./es-mx.js":260,"./es-us":261,"./es-us.js":261,"./es.js":258,"./et":262,"./et.js":262,"./eu":263,"./eu.js":263,"./fa":264,"./fa.js":264,"./fi":265,"./fi.js":265,"./fil":266,"./fil.js":266,"./fo":267,"./fo.js":267,"./fr":268,"./fr-ca":269,"./fr-ca.js":269,"./fr-ch":270,"./fr-ch.js":270,"./fr.js":268,"./fy":271,"./fy.js":271,"./ga":272,"./ga.js":272,"./gd":273,"./gd.js":273,"./gl":274,"./gl.js":274,"./gom-deva":275,"./gom-deva.js":275,"./gom-latn":276,"./gom-latn.js":276,"./gu":277,"./gu.js":277,"./he":278,"./he.js":278,"./hi":279,"./hi.js":279,"./hr":280,"./hr.js":280,"./hu":281,"./hu.js":281,"./hy-am":282,"./hy-am.js":282,"./id":283,"./id.js":283,"./is":284,"./is.js":284,"./it":285,"./it-ch":286,"./it-ch.js":286,"./it.js":285,"./ja":287,"./ja.js":287,"./jv":288,"./jv.js":288,"./ka":289,"./ka.js":289,"./kk":290,"./kk.js":290,"./km":291,"./km.js":291,"./kn":292,"./kn.js":292,"./ko":293,"./ko.js":293,"./ku":294,"./ku.js":294,"./ky":295,"./ky.js":295,"./lb":296,"./lb.js":296,"./lo":297,"./lo.js":297,"./lt":298,"./lt.js":298,"./lv":299,"./lv.js":299,"./me":300,"./me.js":300,"./mi":301,"./mi.js":301,"./mk":302,"./mk.js":302,"./ml":303,"./ml.js":303,"./mn":304,"./mn.js":304,"./mr":305,"./mr.js":305,"./ms":306,"./ms-my":307,"./ms-my.js":307,"./ms.js":306,"./mt":308,"./mt.js":308,"./my":309,"./my.js":309,"./nb":310,"./nb.js":310,"./ne":311,"./ne.js":311,"./nl":312,"./nl-be":313,"./nl-be.js":313,"./nl.js":312,"./nn":314,"./nn.js":314,"./oc-lnc":315,"./oc-lnc.js":315,"./pa-in":316,"./pa-in.js":316,"./pl":317,"./pl.js":317,"./pt":318,"./pt-br":319,"./pt-br.js":319,"./pt.js":318,"./ro":320,"./ro.js":320,"./ru":321,"./ru.js":321,"./sd":322,"./sd.js":322,"./se":323,"./se.js":323,"./si":324,"./si.js":324,"./sk":325,"./sk.js":325,"./sl":326,"./sl.js":326,"./sq":327,"./sq.js":327,"./sr":328,"./sr-cyrl":329,"./sr-cyrl.js":329,"./sr.js":328,"./ss":330,"./ss.js":330,"./sv":331,"./sv.js":331,"./sw":332,"./sw.js":332,"./ta":333,"./ta.js":333,"./te":334,"./te.js":334,"./tet":335,"./tet.js":335,"./tg":336,"./tg.js":336,"./th":337,"./th.js":337,"./tk":338,"./tk.js":338,"./tl-ph":339,"./tl-ph.js":339,"./tlh":340,"./tlh.js":340,"./tr":341,"./tr.js":341,"./tzl":342,"./tzl.js":342,"./tzm":343,"./tzm-latn":344,"./tzm-latn.js":344,"./tzm.js":343,"./ug-cn":345,"./ug-cn.js":345,"./uk":346,"./uk.js":346,"./ur":347,"./ur.js":347,"./uz":348,"./uz-latn":349,"./uz-latn.js":349,"./uz.js":348,"./vi":350,"./vi.js":350,"./x-pseudo":351,"./x-pseudo.js":351,"./yo":352,"./yo.js":352,"./zh-cn":353,"./zh-cn.js":353,"./zh-hk":354,"./zh-hk.js":354,"./zh-mo":355,"./zh-mo.js":355,"./zh-tw":356,"./zh-tw.js":356};function n(e){var t=o(e);return r(t)}function o(e){if(!r.o(map,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return map[e]}n.keys=function(){return Object.keys(map)},n.resolve=o,e.exports=n,n.id=357},364:function(e,t,r){var content=r(384);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(47).default)("0b9abfeb",content,!0,{sourceMap:!1})},383:function(e,t,r){"use strict";r(364)},384:function(e,t,r){var n=r(46)(!1);n.push([e.i,'.flex-container[data-v-6e917e26],.flex-container-header[data-v-6e917e26]{display:flex;align-items:center}.flex-container-header[data-v-6e917e26]{font-weight:900}.normal[data-v-6e917e26]{width:150px;margin:10px}td span[data-v-6e917e26]:after{content:"\\A";white-space:pre}.reduceFontSize[data-v-6e917e26]{font-size:.8em}.navbar-item-link[data-v-6e917e26]{background:#e9ecec}.filterWrapper[data-v-6e917e26]{display:flex;flex-direction:row;justify-content:flex-start;align-items:center}.filterWrapper>div[data-v-6e917e26],.filterWrapper>div>div>div[data-v-6e917e26],.filterWrapper div>div>p[data-v-6e917e26]{margin-left:10px}',""]),e.exports=n},398:function(e,t,r){"use strict";r.r(t);var n=r(22),o=(r(39),r(24),r(63),r(62),r(17),r(149),r(40),r(18),r(51),r(52),r(221)),l=r.n(o);function c(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}function d(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?c(Object(source),!0).forEach((function(t){Object(n.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):c(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var j={middleware:"auth",asyncData:function(e){return e.$axios.get("/api/forms").then((function(e){if(200===e.status){var t=e.data,r=t.ldapGroups,n=t.forms,o=["pending approval","approved","rejected","in progress","completed","deleted"],l=r.map((function(g){return g.username}));return{ldapGroups:r,error:"",statuses:o,groupLeaderUsernames:l,selectedGroupLeaderUsernames:l,allResults:n&&n.length?n:[],query:"",current:1,isAdmin:!1,isGroupLeader:!1,isResearchAssistant:!1,selectedStatuses:o.filter((function(s){return"deleted"!==s})),loading:!0,sessionUser:!1}}var c=e.data.error||"Unexpected issue retrieving forms.";return console.error(c),{error:c}})).catch((function(e){return console.error(e),{error:e}}))},mounted:function(){var e=this.$auth.$state.user,t=e.isAdmin,r=!(!e.isGroupLeaderForObj||!e.isGroupLeaderForObj.username),n=!!e.isResearchAssistantFor;this.isAdmin=t,this.isGroupLeader=r,this.isResearchAssistant=n,this.loading=!1,this.sessionUser=e},computed:{isNormalUser:function(){return!this&&!this.sessionUser||!this.isAdmin&&!this.isGroupLeader&&!this.isResearchAssistant},displayResults:function(){var e=this;return this&&this.sessionUser&&this.sessionUser.username?this.allResults.filter((function(form){if(e.isNormalUser&&form.username!==e.sessionUser.username)return!1;if(!e.sessionUser.signatories.map((function(s){return s.username})).includes(form.signatoryObj.username))return!1;if(!e.selectedGroupLeaderUsernames.includes(form.signatoryObj.username))return!1;if(!e.selectedStatuses.includes(form.status))return!1;if(e.query.length&&!(form.date.toLowerCase().includes(e.query.toLowerCase())||form.username.toLowerCase().includes(e.query.toLowerCase())||form.species.toLowerCase().includes(e.query.toLowerCase())||form.trfId.toLowerCase().includes(e.query.toLowerCase())))return!1;return!0})):[]},isFilterDisabled:function(){return this.query===this.previousQuery||""===this.query},total:function(){return this.displayResults.length},paginatedItems:function(){var e=this.current-1;return this.displayResults.slice().sort((function(a,b){var e=parseInt(a.trfId.match(/\d+/g)[0]),t=parseInt(b.trfId.match(/\d+/g)[0]);return e<t?1:e>t?-1:0})).map((function(e,t){return d(d({},e),{},{position:t+1})})).slice(10*e,10*(e+1))}},methods:{downloadCSVData:function(){var e="TRF ID,Date,Submitter,Species,Genotype,Signatory,Status\n";this.displayResults.forEach((function(form){e+=form.trfId+","+form.date+","+form.username+","+form.species+","+form.genotype+","+form.signatoryObj.username+","+form.status+"\n"}));var t=document.createElement("a");t.href="data:text/csv;charset=utf-8,"+encodeURI(e),t.target="_blank";var r=l()().format("D MMM YYYY, h mm ss a"),title="TRF Forms".concat(this.query?" filtered for "+this.query+",":""," ").concat(r,".csv");t.download=title,t.click()}}},v=(r(383),r(29)),component=Object(v.a)(j,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("h1",{staticClass:"title is-2"},[e._v("View TRF forms")]),e._v(" "),e.error?r("div",[r("div",{staticClass:"notification is-danger"},[r("p",[r("strong",[e._v("Error:")]),e._v(" "+e._s(e.error))])])]):r("div",[e.allResults.length?r("div",[e.sessionUser&&e.sessionUser.signatories.length>1?r("b-field",{staticClass:"filterWrapper",attrs:{label:"Filter by group:"}},[r("div",{staticClass:"block"},e._l(e.groupLeaderUsernames,(function(t,n){return r("b-checkbox",{key:n,attrs:{"native-value":t},model:{value:e.selectedGroupLeaderUsernames,callback:function(t){e.selectedGroupLeaderUsernames=t},expression:"selectedGroupLeaderUsernames"}},[e._v("\n            "+e._s(t)+"\n          ")])})),1)]):e._e(),e._v(" "),r("b-field",{staticClass:"filterWrapper",attrs:{label:"Filter by status:"}},[r("div",{staticClass:"block"},e._l(e.statuses,(function(t,n){return r("b-checkbox",{key:n,attrs:{"native-value":t},model:{value:e.selectedStatuses,callback:function(t){e.selectedStatuses=t},expression:"selectedStatuses"}},[e._v("\n            "+e._s(t.charAt(0).toUpperCase()+t.slice(1))+"\n          ")])})),1)]),e._v(" "),r("b-field",{staticClass:"filterWrapper",attrs:{label:"Filter results:"}},[r("b-input",{attrs:{type:"text",placeholder:"Enter any characters..."},model:{value:e.query,callback:function(t){e.query=t},expression:"query"}}),e._v(" "),r("p",[r("i",[e._v("Filter options: ID #, Date, Submitter, Species")])])],1),e._v(" "),r("div",[r("table",{staticClass:"table"},[r("thead",[r("tr",[r("th"),e._v(" "),r("th",[e._v("ID #")]),e._v(" "),r("th",[e._v("Date")]),e._v(" "),r("th",[e._v("Submitter")]),e._v(" "),r("th",[e._v("Species")]),e._v(" "),e.isGroupLeader||e.isResearchAssistant?e._e():r("th",[e._v("Signatory")]),e._v(" "),r("th",[e._v("Status")])])]),e._v(" "),r("tbody",{directives:[{name:"show",rawName:"v-show",value:e.displayResults.length,expression:"displayResults.length"}]},e._l(e.paginatedItems,(function(form,t){return r("tr",{key:t},[r("td",[e._v(e._s(form.position))]),e._v(" "),r("td",[r("nuxt-link",{staticClass:"navbar-item navbar-item-link",attrs:{to:"/form?id="+form.trfId}},[e._v(e._s(form.trfId))])],1),e._v(" "),r("td",[e._v(e._s(form.date))]),e._v(" "),r("td",[e._v(e._s(form.username))]),e._v(" "),r("td",[e._v(e._s(form.species||"-"))]),e._v(" "),e.isGroupLeader||e.isResearchAssistant?e._e():r("td",[e._v("\n                "+e._s(form.signatoryObj.username)+"\n              ")]),e._v(" "),r("td",[e._v("\n                "+e._s(form.status.charAt(0).toUpperCase()+form.status.slice(1))+"\n              ")])])})),0)]),e._v(" "),e.displayResults.length?r("div",[e._v("\n          "+e._s(e.displayResults.length)+" result"+e._s(1!==e.displayResults.length?"s":"")+"\n          found.\n        ")]):e._e(),e._v(" "),r("b-pagination",{directives:[{name:"show",rawName:"v-show",value:e.displayResults.length>10,expression:"displayResults.length > 10"}],attrs:{total:e.displayResults.length,current:e.current,"per-page":10,"range-before":"1","range-after":"1","icon-prev":"chevron-left","icon-next":"chevron-right","aria-next-label":"Next page","aria-previous-label":"Previous page","aria-page-label":"Page","aria-current-label":"Current page"},on:{"update:current":function(t){e.current=t}}}),e._v(" "),r("tbody",{directives:[{name:"show",rawName:"v-show",value:!e.displayResults.length,expression:"!displayResults.length"}]},[r("td",[e._v("\n            No results"+e._s(this.query.length?' from "'+this.query+'"':"")+".\n          ")])])],1),e._v(" "),r("br"),e._v(" "),e.isAdmin?r("b-button",{attrs:{disabled:!e.displayResults.length},on:{click:this.downloadCSVData}},[e._v("Export to CSV")]):e._e()],1):r("div",[e._v("No results found in database.")])])])}),[],!1,null,"6e917e26",null);t.default=component.exports}}]);